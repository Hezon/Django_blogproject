### 购买域名
### 购买vps，配置vps  
1. 登录[kiwiVM控制面板](https://kiwivm.64clouds.com/main.php)
2. 点击左侧Install new OS，选择ubuntu-14.04-x86_64，安装操作系统

### 搭建服务器
1. 登录搬瓦工帐号，获得服务器的 IP address 、 SSH port 、root的密码
2. 安装xshell
3. 使用xshell登录远程服务器  
    3.1 点击 文件->新建，填写：  
    - 名称：随意
    - 主机：服务器的IP address
    - 端口号：SSH port
    - 其他默认，可以不填
    
    3.2 点击 用户身份验证，之后填写用户名和密码：
    - 用户名：root
    - 搬瓦工帐号上给的root的密码
    
    3.3. 点击 文件->打开，选择刚才创建的会话，完成登录

### 创建超级用户
1. 用root用户登录
2. 执行操作
```
# 在 root 用户下运行这条命令创建一个新用户，hejunyan 是用户名
root@ubuntu:~# useradd -m -s /bin/bash hejunyan

# 把新创建的用户加入超级权限组
root@ubuntu:~# usermod -a -G sudo hejunyan

# 为新用户设置密码
root@ubuntu:~# passwd hejunyan

# 切换到创建的新用户
root@ubuntu:~# su - hejunyan

# 切换成功，@符号前面已经是新用户名而不是 root 了
yangxg@ubuntu:~$
```

### 更新系统
```
hejunyan@ubuntu:~$ sudo apt-get update
hejunyan@ubuntu:~$ sudo apt-get upgrade
```

### 安装软件
需要用到的软件有 Nginx、Pytohn3、Git、pip 和 virtualenv
```
hejunyan@ubuntu:~$ sudo apt-get install nginx
hejunyan@ubuntu:~$ sudo apt-get install git python3 python3-pip
hejunyan@localhost:~$ sudo pip3 install virtualenv
```

### 解析域名到服务器的 IP 地址
使用的阿里云域名解析

### 启动 Nginx 服务
服务器会接收到下面两种请求：
- 显示文章的详情信息，这些信息通常保存在数据库里，因此需要调用数据库获取数据。
- 图片、css、js 等存在服务器某个文件夹下的静态文件。

对于前一种请求，博客文章的数据需要借助 Django 从数据库中获取，它就会把这个请求转发给 Django，让 Django 去处理。 

而对于后一种静态文件的请求，只需要去这些静态文件所在的文件夹获取，Nginx 就会代为处理。

运行下面的命令启动 Nginx 服务：
```
yangxg@localhost:~$ sudo service nginx start
```

## 部署代码
### 部署前的项目配置
STATIC_ROOT 指明了静态文件的收集目录
```
# blogproject/settings.py

...
STATIC_URL = '/static/'
+ STATIC_ROOT = os.path.join(BASE_DIR, 'static')
```

在生产环境下需要关闭 DEBUG 选项以及设置允许访问的域名
```
# blogproject/settings.py

...
+ DEBUG = False
+ ALLOWED_HOSTS = ['127.0.0.1', 'localhost ', '.toeast.info', '.jyan.pro'] # 域名前加一个点表示允许访问该域名下的子域名
```

项目还会依赖一些第三方 Python 库，为了方便在服务器上一次性安装，我们将全部依赖写入一个叫 requirements.txt 的文本文件中。激活本地的虚拟环境（如果你使用了虚拟环境的话），并进入项目的根目录，运行
```
pip freeze > requirements.txt
```
